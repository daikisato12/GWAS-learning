### Quality Control
#### 個体のフィルタリング
- call rateの低い (e.g. <0.98) 個体を除く.
- 血縁関係にある個体 (e.g. PI_HAT > 0.12, p(IBD = 0) < 0.05 etc.) を除く.
- (ヒトの場合) 自己申告と遺伝的な性が一致しない人を除く. 
- 表現型との混交を避けるため, 同一集団に由来する遺伝的背景が均一な個体を使い, 内部の集団構造が存在しないことが重要. PCAにより, 各集団から外れる個体を除くなど.

#### SNPsのフィルタリング
- call rateの低い (e.g. <0.99) SNPsを除く.
- ジェノタイピングのエラーを避けるため, マイナーアリル頻度（Minor Allele Frquency: MAF）が低い (e.g. <1%) SNPsは排除する. サンプル数が多ければ, 低頻度のアリルもエラーでなく捉えることができるため, この閾値はサンプル数に依存する.
- (計算の煩雑さのため?) 遺伝子型が2つの (Biallelicな) SNPsのみを対象とする.
- Hardy–Weinberg Equilibriumに沿わない (e.g. p < 1×10^–6) SNPsは除く.

### Imputation

### 表現型データをどう扱うか
- 2値データ (例えば疾患の有無) や 単純な連続値 (体重や身長など) はそのまま扱えばいい.
- アンケートデータを元にした順序尺度 (`1.全く当てはまらない` ~ `5. 非常によく当てはまる`) などは色々とやり方がある.
  - (複数項目あれば) 合計得点を表現型とする.
  - (連続値に近似可能であれば) 各順位に点数を割り当てる (e.g. `１ヶ月の飲酒頻度は？`という質問に対して, `1. 全く飲まない`であれば0, `2. 月に1回以下`は0.12, `3. 月に1~3回`であれば0.46, `4. 週に1,2回`であれば1.5など, 1週間に飲む回数の期待値を割り当てる).